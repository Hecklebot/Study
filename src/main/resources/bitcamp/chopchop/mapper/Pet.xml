<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.chopchop.dao.PetDao">

<resultMap type="Pet" id="PetMap">
  <id column="pet_id" property="petNo"/>
  <result column="name" property="name"/>
  <result column="created_date" property="createdDate"/>
  <result column="register_no" property="registerNo"/>
  <result column="photo" property="photo"/>
</resultMap> 

  <sql id="basicColumn">
    select
    pet_id,
    name,
  </sql>

  <insert id="insert" parameterType="Member">
    insert into member
    (
    email,
    password,
    nickname,
    tel
    )
    value
    (
    #{email},
    password(#{password}),
    #{nickname},
    #{tel}
    )
  </insert>

  <select id="findAll" resultMap="MemberMap">
    select * from member
  </select>

  <select id="findBy" parameterType="int" resultMap="MemberMap">
    <include refid="basicColumn" />
    ,
    photo,
    post_no,
    base_address,
    detail_address
    from member
    where member_id = #{memberNo}
  </select>

  <update id="update" parameterType="Member">
    update member
    <set>
      <if test="email != null">email=#{email},</if>
      <if test="password != null">password=password(#{password}), </if>
      <if test="nickname != null">nickname=#{nickname},</if>
      <if test="tel != null">tel=#{tel},</if>
      <if test="photo != null">photo=#{photo},</if>
      <if test="postNo != null">post_no=#{postNo},</if>
      <if test="baseAddress != null">base_address=#{baseAddress},</if>
      <if test="detailAddress != null">detail_address=#{detailAddress}</if>
    </set>
    where member_id = #{memberNo}
  </update>
  
  <delete id="delete" parameterType="int">
    delete from member
    where member_id = #{member.memberNo}
  </delete>
</mapper>